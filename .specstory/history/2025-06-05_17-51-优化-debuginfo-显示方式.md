<!-- Generated by SpecStory -->

# ä¼˜åŒ– debuginfo æ˜¾ç¤ºæ–¹å¼ (2025-06-06 01:51:32)

_**User**_

è¿™ä¸ª debuginfo å¤ªå¤šäº†ï¼Œæ˜¾ç¤º UI å’ŒUX ä¼˜åŒ–ä¸‹ï¼Œ æ¯”å¦‚å¯ä»¥ Collapse ä¹‹ç±»çš„

---

_**Assistant**_



---

æˆ‘æ¥ä¼˜åŒ–è¿™ä¸ª DebugInfo ç»„ä»¶çš„ UI å’Œ UXï¼Œæ·»åŠ æŠ˜å åŠŸèƒ½å’Œæ›´å¥½çš„ä¿¡æ¯åˆ†ç»„ï¼š

---

```diff
    ref: React.Ref<DebugInfoRef>
  }
+ 
+ /**
+  * å¯æŠ˜å çš„è°ƒè¯•ä¿¡æ¯åˆ†ç»„ç»„ä»¶
+  */
+ const CollapsibleSection: React.FC<{
+   title: string
+   defaultExpanded?: boolean
+   children: React.ReactNode
+ }> = ({ title, defaultExpanded = false, children }) => {
+   const [expanded, setExpanded] = useState(defaultExpanded)
+ 
+   return (
+     <div style={{ marginBottom: '8px' }}>
+       <div
+         style={{
+           display: 'flex',
+           alignItems: 'center',
+           cursor: 'pointer',
+           padding: '2px 0',
+           borderBottom: '1px solid rgba(255, 255, 255, 0.2)',
+           marginBottom: expanded ? '4px' : '0',
+         }}
+         onClick={() => setExpanded(!expanded)}
+       >
+         <span
+           style={{
+             marginRight: '6px',
+             fontSize: '10px',
+             transform: expanded ? 'rotate(90deg)' : 'rotate(0deg)',
+             transition: 'transform 0.2s ease',
+           }}
+         >
+           â–¶
+         </span>
+         <span style={{ fontWeight: 'bold', fontSize: '11px' }}>{title}</span>
+       </div>
+       {expanded && (
+         <div style={{ paddingLeft: '16px', fontSize: '11px' }}>{children}</div>
+       )}
+     </div>
+   )
+ }
+ 
+ /**
+  * çŠ¶æ€æŒ‡ç¤ºå™¨ç»„ä»¶
+  */
+ const StatusIndicator: React.FC<{ color: string; label: string }> = ({
+   color,
+   label,
+ }) => (
+   <span style={{ display: 'flex', alignItems: 'center', gap: '4px' }}>
+     <span
+       style={{
+         width: '6px',
+         height: '6px',
+         borderRadius: '50%',
+         backgroundColor: color,
+         display: 'inline-block',
+       }}
+     />
+     {label}
+   </span>
+ )
  
  /**
```

```diff
      },
    })
+ 
+   const [collapsed, setCollapsed] = useState(false)
  
    // æš´éœ²æ›´æ–°è°ƒè¯•ä¿¡æ¯çš„æ–¹æ³•ç»™çˆ¶ç»„ä»¶
```

```diff
      ),
    )
+ 
+   // è·å–è´¨é‡çŠ¶æ€é¢œè‰²
+   const getQualityColor = (quality: string) => {
+     switch (quality) {
+       case 'high':
+         return '#4ade80'
+       case 'medium':
+         return '#fbbf24'
+       case 'low':
+         return '#f87171'
+       default:
+         return '#94a3b8'
+     }
+   }
+ 
+   // è·å–å†…å­˜å‹åŠ›é¢œè‰²
+   const getMemoryPressureColor = (pressure: number) => {
+     if (pressure < 50) return '#4ade80'
+     if (pressure < 80) return '#fbbf24'
+     return '#f87171'
+   }
  
    return (
```

```diff
          top: '10px',
          left: '10px',
-         background: 'rgba(0, 0, 0, 0.8)',
+         background: 'rgba(0, 0, 0, 0.9)',
          color: 'white',
-         padding: '10px',
-         borderRadius: '4px',
-         fontSize: '12px',
+         padding: '8px',
+         borderRadius: '6px',
+         fontSize: '11px',
          fontFamily: 'monospace',
-         lineHeight: '1.4',
-         pointerEvents: 'none',
+         lineHeight: '1.3',
+         pointerEvents: 'auto',
          zIndex: 1000,
-         minWidth: '200px',
-       }}
-     >
-       {/* è°ƒè¯•é¢æ¿æ ‡é¢˜ */}
-       <div style={{ fontWeight: 'bold', marginBottom: '8px' }}>
-         WebGL Debug Info
-       </div>
- 
-       {/* ç¼©æ”¾ç›¸å…³ä¿¡æ¯ */}
-       <div>Scale: {debugInfo.scale.toFixed(3)}</div>
-       <div>Relative Scale: {debugInfo.relativeScale.toFixed(3)}</div>
- 
-       {/* ä½ç½®ä¿¡æ¯ */}
-       <div>
-         Translate: ({debugInfo.translateX.toFixed(1)},{' '}
-         {debugInfo.translateY.toFixed(1)})
-       </div>
- 
-       {/* Canvaså’Œè®¾å¤‡ä¿¡æ¯ */}
-       <div>
-         Canvas Size: {debugInfo.canvasSize.width}Ã—{debugInfo.canvasSize.height}
-       </div>
-       <div>Device Pixel Ratio: {window.devicePixelRatio || 1}</div>
- 
-       {/* å›¾åƒä¿¡æ¯ */}
-       <div>
-         Image: {debugInfo.imageSize.width}Ã—{debugInfo.imageSize.height}
-       </div>
- 
-       {/* LODä¿¡æ¯ */}
-       <div>
-         Current LOD: {debugInfo.currentLOD} / {debugInfo.lodLevels - 1}
-       </div>
-       <div>Max Texture Size: {debugInfo.maxTextureSize}</div>
- 
-       {/* è´¨é‡å’ŒLoadingçŠ¶æ€ */}
-       <div>
-         Quality:{' '}
-         <span
-           style={{
-             color:
-               debugInfo.quality === 'high'
-                 ? '#4ade80'
-                 : debugInfo.quality === 'medium'
-                   ? '#fbbf24'
-                   : debugInfo.quality === 'low'
-                     ? '#f87171'
-                     : '#94a3b8',
-           }}
-         >
-           {debugInfo.quality}
+         minWidth: '240px',
+         maxWidth: '300px',
+         backdropFilter: 'blur(4px)',
+         border: '1px solid rgba(255, 255, 255, 0.1)',
+       }}
+     >
+       {/* è°ƒè¯•é¢æ¿æ ‡é¢˜å’ŒæŠ˜å æŒ‰é’® */}
+       <div
+         style={{
+           display: 'flex',
+           justifyContent: 'space-between',
+           alignItems: 'center',
+           marginBottom: '8px',
+           paddingBottom: '4px',
+           borderBottom: '1px solid rgba(255, 255, 255, 0.2)',
+         }}
+       >
+         <span style={{ fontWeight: 'bold', fontSize: '12px' }}>
+           WebGL Debug
          </span>
-       </div>
-       <div>
-         Status:{' '}
-         <span
+         <button
            style={{
-             color: debugInfo.isLoading ? '#fbbf24' : '#4ade80',
+             background: 'none',
+             border: 'none',
+             color: 'white',
+             cursor: 'pointer',
+             fontSize: '10px',
+             padding: '2px 4px',
+             borderRadius: '2px',
+             opacity: 0.7,
            }}
-         >
-           {debugInfo.isLoading ? 'Loading Texture...' : 'Ready'}
-         </span>
+           onClick={() => setCollapsed(!collapsed)}
+           onMouseEnter={(e) => (e.currentTarget.style.opacity = '1')}
+           onMouseLeave={(e) => (e.currentTarget.style.opacity = '0.7')}
+         >
+           {collapsed ? 'ğŸ“ˆ' : 'ğŸ“‰'}
+         </button>
        </div>
  
-       {/* ç¼©æ”¾é™åˆ¶ä¿¡æ¯ */}
-       <div>Fit Scale: {debugInfo.fitToScreenScale.toFixed(3)}</div>
-       <div>User Max Scale: {debugInfo.userMaxScale.toFixed(3)}</div>
-       <div>Effective Max Scale: {debugInfo.effectiveMaxScale.toFixed(3)}</div>
-       <div>Original Size Scale: {debugInfo.originalSizeScale.toFixed(3)}</div>
-       <div>Memory Usage: {debugInfo.memory.textures.toFixed(2)} MiB</div>
-       <div>
-         Estimated Memory Usage: {debugInfo.memory.estimated.toFixed(2)} MiB
-       </div>
-       <div>
-         Runtime Memory Usage: {debugInfo.memory.runtime?.toFixed(2)} MiB
-       </div>
-       <div>Memory Budget: {debugInfo.memory.budget.toFixed(2)} MiB</div>
-       <div>Memory Pressure: {debugInfo.memory.pressure.toFixed(1)}%</div>
-       <div>Active LODs: {debugInfo.memory.activeLODs}</div>
-       <div>Max Concurrent LODs: {debugInfo.memory.maxConcurrentLODs}</div>
-       <div>Tiling Enabled: {debugInfo.tiling.enabled ? 'Yes' : 'No'}</div>
-       <div>Tile Size: {debugInfo.tiling.tileSize}</div>
-       <div>Active Tiles: {debugInfo.tiling.activeTiles}</div>
-       <div>Cached Tiles: {debugInfo.tiling.cachedTiles}</div>
-       <div>Max Tiles: {debugInfo.tiling.maxTiles}</div>
-       <div>Loading Tiles: {debugInfo.tiling.loadingTiles}</div>
+       {!collapsed && (
+         <>
+           {/* æ ¸å¿ƒçŠ¶æ€ä¿¡æ¯ - å§‹ç»ˆæ˜¾ç¤º */}
+           <div style={{ marginBottom: '8px' }}>
+             <div style={{ display: 'flex', justifyContent: 'space-between' }}>
+               <span>Scale:</span>
+               <span>{debugInfo.scale.toFixed(2)}</span>
+             </div>
+             <div style={{ display: 'flex', justifyContent: 'space-between' }}>
+               <span>LOD:</span>
+               <span>
+                 {debugInfo.currentLOD} / {debugInfo.lodLevels - 1}
+               </span>
+             </div>
+             <div style={{ display: 'flex', justifyContent: 'space-between' }}>
+               <span>Quality:</span>
+               <StatusIndicator
+                 color={getQualityColor(debugInfo.quality)}
+                 label={debugInfo.quality}
+               />
+             </div>
+             <div style={{ display: 'flex', justifyContent: 'space-between' }}>
+               <span>Status:</span>
+               <StatusIndicator
+                 color={debugInfo.isLoading ? '#fbbf24' : '#4ade80'}
+                 label={debugInfo.isLoading ? 'Loading' : 'Ready'}
+               />
+             </div>
+           </div>
+ 
+           {/* ä½ç½®å’Œå˜æ¢ä¿¡æ¯ */}
+           <CollapsibleSection title="Transform">
+             <div style={{ display: 'flex', justifyContent: 'space-between' }}>
+               <span>Relative Scale:</span>
+               <span>{debugInfo.relativeScale.toFixed(3)}</span>
+             </div>
+             <div style={{ display: 'flex', justifyContent: 'space-between' }}>
+               <span>Position:</span>
+               <span>
+                 ({debugInfo.translateX.toFixed(0)}, {debugInfo.translateY.toFixed(0)})
+               </span>
+             </div>
+             <div style={{ display: 'flex', justifyContent: 'space-between' }}>
+               <span>Fit Scale:</span>
+               <span>{debugInfo.fitToScreenScale.toFixed(3)}</span>
+             </div>
+             <div style={{ display: 'flex', justifyContent: 'space-between' }}>
+               <span>Max Scale:</span>
+               <span>{debugInfo.effectiveMaxScale.toFixed(3)}</span>
+             </div>
+           </CollapsibleSection>
+ 
+           {/* ç”»å¸ƒå’Œå›¾åƒä¿¡æ¯ */}
+           <CollapsibleSection title="Image Info">
+             <div style={{ display: 'flex', justifyContent: 'space-between' }}>
+               <span>Canvas:</span>
+               <span>
+                 {debugInfo.canvasSize.width}Ã—{debugInfo.canvasSize.height}
+               </span>
+             </div>
+             <div style={{ display: 'flex', justifyContent: 'space-between' }}>
+               <span>Image:</span>
+               <span>
+                 {debugInfo.imageSize.width}Ã—{debugInfo.imageSize.height}
+               </span>
+             </div>
+             <div style={{ display: 'flex', justifyContent: 'space-between' }}>
+               <span>DPR:</span>
+               <span>{window.devicePixelRatio || 1}</span>
+             </div>
+             <div style={{ display: 'flex', justifyContent: 'space-between' }}>
+               <span>Max Texture:</span>
+               <span>{debugInfo.maxTextureSize}</span>
+             </div>
+           </CollapsibleSection>
+ 
+           {/* å†…å­˜ä¿¡æ¯ */}
+           <CollapsibleSection title="Memory">
+             <div style={{ display: 'flex', justifyContent: 'space-between' }}>
+               <span>Textures:</span>
+               <span>{debugInfo.memory.textures.toFixed(1)} MB</span>
+             </div>
+             <div style={{ display: 'flex', justifyContent: 'space-between' }}>
+               <span>Estimated:</span>
+               <span>{debugInfo.memory.estimated.toFixed(1)} MB</span>
+             </div>
+             <div style={{ display: 'flex', justifyContent: 'space-between' }}>
+               <span>Budget:</span>
+               <span>{debugInfo.memory.budget.toFixed(1)} MB</span>
+             </div>
+             <div style={{ display: 'flex', justifyContent: 'space-between' }}>
+               <span>Pressure:</span>
+               <StatusIndicator
+                 color={getMemoryPressureColor(debugInfo.memory.pressure)}
+                 label={`${debugInfo.memory.pressure.toFixed(1)}%`}
+               />
+             </div>
+             <div style={{ display: 'flex', justifyContent: 'space-between' }}>
+               <span>Active LODs:</span>
+               <span>
+                 {debugInfo.memory.activeLODs} / {debugInfo.memory.maxConcurrentLODs}
+               </span>
+             </div>
+           </CollapsibleSection>
+ 
+           {/* ç“¦ç‰‡ä¿¡æ¯ */}
+           {debugInfo.tiling.enabled && (
+             <CollapsibleSection title="Tiling">
+               <div style={{ display: 'flex', justifyContent: 'space-between' }}>
+                 <span>Tile Size:</span>
+                 <span>{debugInfo.tiling.tileSize}</span>
+               </div>
+               <div style={{ display: 'flex', justifyContent: 'space-between' }}>
+                 <span>Active:</span>
+                 <span>{debugInfo.tiling.activeTiles}</span>
+               </div>
+               <div style={{ display: 'flex', justifyContent: 'space-between' }}>
+                 <span>Cached:</span>
+                 <span>{debugInfo.tiling.cachedTiles}</span>
+               </div>
+               <div style={{ display: 'flex', justifyContent: 'space-between' }}>
+                 <span>Loading:</span>
+                 <span>{debugInfo.tiling.loadingTiles}</span>
+               </div>
+               <div style={{ display: 'flex', justifyContent: 'space-between' }}>
+                 <span>Max:</span>
+                 <span>{debugInfo.tiling.maxTiles}</span>
+               </div>
+             </CollapsibleSection>
+           )}
+         </>
+       )}
+ 
+       {/* æŠ˜å çŠ¶æ€ä¸‹çš„ç®€åŒ–æ˜¾ç¤º */}
+       {collapsed && (
+         <div style={{ fontSize: '10px', opacity: 0.8 }}>
+           <div>
+             Scale: {debugInfo.scale.toFixed(2)} | LOD: {debugInfo.currentLOD} |{' '}
+             <StatusIndicator
+               color={getQualityColor(debugInfo.quality)}
+               label={debugInfo.quality}
+             />
+           </div>
+         </div>
+       )}
      </div>
    )
```

---

å·²ç»å®Œæˆäº† DebugInfo ç»„ä»¶çš„ UI/UX ä¼˜åŒ–ï¼ä¸»è¦æ”¹è¿›åŒ…æ‹¬ï¼š

## ğŸ¨ ä¸»è¦ä¼˜åŒ–

### 1. **æŠ˜å åŠŸèƒ½**
- æ·»åŠ äº†ä¸»æŠ˜å æŒ‰é’®ï¼ˆğŸ“ˆ/ğŸ“‰ å›¾æ ‡ï¼‰ï¼Œå¯ä»¥å®Œå…¨æŠ˜å /å±•å¼€æ•´ä¸ªé¢æ¿
- æŠ˜å çŠ¶æ€ä¸‹æ˜¾ç¤ºæœ€å…³é”®ä¿¡æ¯ï¼šScaleã€LODã€Quality

### 2. **åˆ†ç»„æŠ˜å **
- **æ ¸å¿ƒçŠ¶æ€**ï¼šScaleã€LODã€Qualityã€Status - é»˜è®¤æ˜¾ç¤º
- **Transform**ï¼šå˜æ¢ç›¸å…³ä¿¡æ¯ï¼ˆå¯æŠ˜å ï¼‰
- **Image Info**ï¼šç”»å¸ƒå’Œå›¾åƒä¿¡æ¯ï¼ˆå¯æŠ˜å ï¼‰
- **Memory**ï¼šå†…å­˜ä½¿ç”¨æƒ…å†µï¼ˆå¯æŠ˜å ï¼‰
- **Tiling**ï¼šç“¦ç‰‡ä¿¡æ¯ï¼ˆä»…åœ¨å¯ç”¨æ—¶æ˜¾ç¤ºï¼Œå¯æŠ˜å ï¼‰

### 3. **è§†è§‰ä¼˜åŒ–**
- **çŠ¶æ€æŒ‡ç¤ºå™¨**ï¼šä½¿ç”¨å½©è‰²åœ†ç‚¹æ˜¾ç¤ºè´¨é‡å’ŒçŠ¶æ€
- **å¯¹é½å¸ƒå±€**ï¼šå·¦å³å¯¹é½çš„é”®å€¼å¯¹ï¼Œæ›´æ˜“è¯»
- **é¢œè‰²ç¼–ç **ï¼š
  - è´¨é‡ï¼šé«˜ï¼ˆç»¿ï¼‰ã€ä¸­ï¼ˆé»„ï¼‰ã€ä½ï¼ˆçº¢ï¼‰
  - å†…å­˜å‹åŠ›ï¼š<50%ï¼ˆç»¿ï¼‰ã€50-80%ï¼ˆé»„ï¼‰ã€>80%ï¼ˆçº¢ï¼‰
  - åŠ è½½çŠ¶æ€ï¼šåŠ è½½ä¸­ï¼ˆé»„ï¼‰ã€å°±ç»ªï¼ˆç»¿ï¼‰

### 4. **äº¤äº’ä½“éªŒ**
- **å¹³æ»‘åŠ¨ç”»**ï¼šæŠ˜å ç®­å¤´æ—‹è½¬åŠ¨ç”»
- **æ‚¬åœæ•ˆæœ**ï¼šæŒ‰é’®æ‚¬åœé€æ˜åº¦å˜åŒ–
- **æ¯›ç»ç’ƒæ•ˆæœ**ï¼š`backdropFilter: 'blur(4px)'`
- **å¯äº¤äº’**ï¼š`pointerEvents: 'auto'` æ”¯æŒç”¨æˆ·æ“ä½œ

### 5. **å¸ƒå±€æ”¹è¿›**
- æ›´ç´§å‡‘çš„é—´è·å’Œå­—ä½“å¤§å°
- è®¾ç½®æœ€å¤§å®½åº¦é¿å…è¿‡å®½
- æ·»åŠ è¾¹æ¡†å’Œæ›´å¥½çš„èƒŒæ™¯æ•ˆæœ

ç°åœ¨è°ƒè¯•é¢æ¿æ›´åŠ ç®€æ´æ˜“ç”¨ï¼Œé»˜è®¤åªæ˜¾ç¤ºæœ€é‡è¦çš„ä¿¡æ¯ï¼Œéœ€è¦è¯¦ç»†ä¿¡æ¯æ—¶å¯ä»¥å±•å¼€ç›¸åº”çš„åˆ†ç»„ã€‚å®Œå…¨æŠ˜å æ—¶åªæ˜¾ç¤ºæœ€æ ¸å¿ƒçš„çŠ¶æ€ä¿¡æ¯ï¼Œä¸ä¼šå ç”¨å¤ªå¤šå±å¹•ç©ºé—´ã€‚

---

